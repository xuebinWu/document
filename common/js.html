<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript规范 | 前端开发文档</title>
    <meta name="description" content="Just do it">
    <link rel="icon" href="/document/favicon.ico">
  <link rel="manifest" href="/document/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/document/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/document/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/document/assets/css/0.styles.b6ddce4f.css" as="style"><link rel="preload" href="/document/assets/js/app.11bfe46c.js" as="script"><link rel="preload" href="/document/assets/js/2.9124a432.js" as="script"><link rel="preload" href="/document/assets/js/19.b8279340.js" as="script"><link rel="prefetch" href="/document/assets/js/10.bc4a8582.js"><link rel="prefetch" href="/document/assets/js/11.d04213b8.js"><link rel="prefetch" href="/document/assets/js/12.3ed00703.js"><link rel="prefetch" href="/document/assets/js/13.c7529a8f.js"><link rel="prefetch" href="/document/assets/js/14.0b16b6be.js"><link rel="prefetch" href="/document/assets/js/15.a75e7064.js"><link rel="prefetch" href="/document/assets/js/16.48508413.js"><link rel="prefetch" href="/document/assets/js/17.9e041e6c.js"><link rel="prefetch" href="/document/assets/js/18.1960fbda.js"><link rel="prefetch" href="/document/assets/js/20.b2e11144.js"><link rel="prefetch" href="/document/assets/js/21.52efd26e.js"><link rel="prefetch" href="/document/assets/js/22.ea2de4d3.js"><link rel="prefetch" href="/document/assets/js/23.805e49c5.js"><link rel="prefetch" href="/document/assets/js/24.acedacf2.js"><link rel="prefetch" href="/document/assets/js/25.b817f5aa.js"><link rel="prefetch" href="/document/assets/js/26.55aaea3d.js"><link rel="prefetch" href="/document/assets/js/27.50a90cf1.js"><link rel="prefetch" href="/document/assets/js/28.c956c552.js"><link rel="prefetch" href="/document/assets/js/29.e2848b02.js"><link rel="prefetch" href="/document/assets/js/3.ce51a7f6.js"><link rel="prefetch" href="/document/assets/js/30.dba80749.js"><link rel="prefetch" href="/document/assets/js/31.f411745a.js"><link rel="prefetch" href="/document/assets/js/32.906e4c42.js"><link rel="prefetch" href="/document/assets/js/33.938d8e39.js"><link rel="prefetch" href="/document/assets/js/34.73e9fcb3.js"><link rel="prefetch" href="/document/assets/js/35.9e8f72e7.js"><link rel="prefetch" href="/document/assets/js/36.62e66f83.js"><link rel="prefetch" href="/document/assets/js/37.de5dda7d.js"><link rel="prefetch" href="/document/assets/js/38.86f97598.js"><link rel="prefetch" href="/document/assets/js/39.21e8697b.js"><link rel="prefetch" href="/document/assets/js/4.f6eb3884.js"><link rel="prefetch" href="/document/assets/js/40.a3d783bc.js"><link rel="prefetch" href="/document/assets/js/41.a83b58d4.js"><link rel="prefetch" href="/document/assets/js/42.40805dc4.js"><link rel="prefetch" href="/document/assets/js/43.20de0011.js"><link rel="prefetch" href="/document/assets/js/44.c089b71c.js"><link rel="prefetch" href="/document/assets/js/45.e1cde9f4.js"><link rel="prefetch" href="/document/assets/js/46.8c0bcc46.js"><link rel="prefetch" href="/document/assets/js/47.e5417872.js"><link rel="prefetch" href="/document/assets/js/48.5000993e.js"><link rel="prefetch" href="/document/assets/js/49.2a36dcf6.js"><link rel="prefetch" href="/document/assets/js/5.3aa9caae.js"><link rel="prefetch" href="/document/assets/js/50.a41ea630.js"><link rel="prefetch" href="/document/assets/js/51.dbb672dc.js"><link rel="prefetch" href="/document/assets/js/52.f74b3aea.js"><link rel="prefetch" href="/document/assets/js/53.9dd7ba09.js"><link rel="prefetch" href="/document/assets/js/54.c4290dad.js"><link rel="prefetch" href="/document/assets/js/55.f0ef3f0b.js"><link rel="prefetch" href="/document/assets/js/56.5a4882ed.js"><link rel="prefetch" href="/document/assets/js/57.f25760ff.js"><link rel="prefetch" href="/document/assets/js/58.3f391cd7.js"><link rel="prefetch" href="/document/assets/js/59.29265aae.js"><link rel="prefetch" href="/document/assets/js/6.2c676f3d.js"><link rel="prefetch" href="/document/assets/js/60.86647961.js"><link rel="prefetch" href="/document/assets/js/61.18fe319b.js"><link rel="prefetch" href="/document/assets/js/7.b0ade46c.js"><link rel="prefetch" href="/document/assets/js/8.6f19a53a.js"><link rel="prefetch" href="/document/assets/js/9.5e1ff4de.js">
    <link rel="stylesheet" href="/document/assets/css/0.styles.b6ddce4f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/document/" class="home-link router-link-active"><!----> <span class="site-name">前端开发文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/document/common/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/document/template/" class="nav-link">工程模板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">组件库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://122687220.github.io/zv-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ZvUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://122687220.github.io/fine-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FineUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">端开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/mobile/" class="nav-link">移动端</a></li><li class="dropdown-item"><!----> <a href="/document/PC/" class="nav-link">PC端</a></li><li class="dropdown-item"><!----> <a href="/document/miniprogramme/" class="nav-link">小程序</a></li></ul></div></div><div class="nav-item"><a href="/document/experience/" class="nav-link">知识库</a></div><div class="nav-item"><a href="/document/other/" class="nav-link">工程化相关</a></div> <a href="https://github.com/122687220/document" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/document/common/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/document/template/" class="nav-link">工程模板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">组件库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://122687220.github.io/zv-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ZvUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://122687220.github.io/fine-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  FineUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">端开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/mobile/" class="nav-link">移动端</a></li><li class="dropdown-item"><!----> <a href="/document/PC/" class="nav-link">PC端</a></li><li class="dropdown-item"><!----> <a href="/document/miniprogramme/" class="nav-link">小程序</a></li></ul></div></div><div class="nav-item"><a href="/document/experience/" class="nav-link">知识库</a></div><div class="nav-item"><a href="/document/other/" class="nav-link">工程化相关</a></div> <a href="https://github.com/122687220/document" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>编码规范</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/document/common/" class="sidebar-link">指南</a></li><li><a href="/document/common/standard.html" class="sidebar-link">通用书写规范</a></li><li><a href="/document/common/html.html" class="sidebar-link">HTML规范</a></li><li><a href="/document/common/js.html" class="active sidebar-link">JS规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/common/js.html#通用约定" class="sidebar-link">通用约定</a></li><li class="sidebar-sub-header"><a href="/document/common/js.html#函数设计" class="sidebar-link">函数设计</a></li><li class="sidebar-sub-header"><a href="/document/common/js.html#性能优化" class="sidebar-link">性能优化</a></li><li class="sidebar-sub-header"><a href="/document/common/js.html#调试" class="sidebar-link">调试</a></li></ul></li><li><a href="/document/common/css.html" class="sidebar-link">CSS规范</a></li><li><a href="/document/common/vue.html" class="sidebar-link">Vue规范</a></li><li><a href="/document/common/git-commit.html" class="sidebar-link">Git提交日志规范</a></li><li><a href="/document/common/git-flow.html" class="sidebar-link">Git分支策略</a></li><li><a href="/document/common/code-review.html" class="sidebar-link">Code Review</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript规范"><a href="#javascript规范" aria-hidden="true" class="header-anchor">#</a> JavaScript规范</h1> <h2 id="通用约定"><a href="#通用约定" aria-hidden="true" class="header-anchor">#</a> 通用约定</h2> <h3 id="注释原则"><a href="#注释原则" aria-hidden="true" class="header-anchor">#</a> 注释原则</h3> <ul><li>As short as possible（如无必要，勿增注释）：尽量提高代码本身的清晰性、可读性。</li> <li>As long as necessary（如有必要，尽量详尽）：合理的注释、空行排版等，可以让代码更易阅读、更具美感。</li> <li>禁止使用var</li></ul> <h3 id="命名"><a href="#命名" aria-hidden="true" class="header-anchor">#</a> 命名</h3> <p>变量, 使用驼峰命名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> loadingModules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>私有属性、变量和方法以下划线 _ 开头。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> _privateMethod <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>常量, 使用全部字母大写，禁止使用let、var定义常量。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">MAXCOUNT</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>枚举变量 使用 Pascal 命名法。 枚举的属性， 使用全部字母大写，单词间下划线分隔的命名方式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> TargetState <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token constant">READING</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token constant">READED</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token constant">APPLIED</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token constant">READY</span><span class="token punctuation">:</span> <span class="token number">4</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>boolean 类型的变量使用 is、 has、can 开头。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> isReady <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">let</span> hasMoreCommands <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="二元和三元操作符"><a href="#二元和三元操作符" aria-hidden="true" class="header-anchor">#</a> 二元和三元操作符</h3> <p>操作符始终写在前一行, 以免分号的隐式插入产生预想不到的问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> a <span class="token operator">?</span> b <span class="token punctuation">:</span> c<span class="token punctuation">;</span><span class="token keyword">let</span> y <span class="token operator">=</span> a <span class="token operator">?</span>
    longButSimpleOperandB <span class="token punctuation">:</span> longButSimpleOperandC<span class="token punctuation">;</span><span class="token keyword">let</span> z <span class="token operator">=</span> a <span class="token operator">?</span>
        moreComplicatedB <span class="token punctuation">:</span>
        moreComplicatedC<span class="token punctuation">;</span>
</code></pre></div><p>操作符也是如此：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">doSomethingElse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="条件-三元-操作符"><a href="#条件-三元-操作符" aria-hidden="true" class="header-anchor">#</a> 条件(三元)操作符 ( ? : )</h3> <p>三元操作符用于替代 if 条件判断语句。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不推荐</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 推荐</span>
<span class="token keyword">return</span> val <span class="token operator">?</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="和"><a href="#和" aria-hidden="true" class="header-anchor">#</a> &amp;&amp; 和 ||</h3> <p>二元布尔操作符是可短路的, 只有在必要时才会计算到最后一项。例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不推荐</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">opt_win</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> win<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opt_win<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        win <span class="token operator">=</span> opt_win
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        win <span class="token operator">=</span> window
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>kids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>kids<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">foo</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>kids<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推荐</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">opt_win</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> win <span class="token operator">=</span> opt_win <span class="token operator">||</span> window<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> kid <span class="token operator">=</span> node <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>kids <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>kids<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>kid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>kid<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="声明提升"><a href="#声明提升" aria-hidden="true" class="header-anchor">#</a> 声明提升</h3> <ul><li>var 声明会被提升至该作用域的顶部，但它们赋值不会提升。let 和 const 被赋予了一种称为「暂时性死区（Temporal Dead Zones, TDZ）」的概念。这对于了解为什么 type of 不再安全相当重要。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 我们知道这样运行不了</span>
<span class="token comment">// （假设 notDefault 不是全局变量）</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>notDefault<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; throws a ReferenceError</span>
<span class="token punctuation">}</span>

<span class="token comment">// 由于变量提升的原因， 在引用变量后再声明变量是可以运行的</span>
<span class="token comment">// 注：变量的赋值 `true` 不会被提升</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>declaredButNotAssigned<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>
    <span class="token keyword">var</span> declaredButNotAssigned <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编译器会把函数声明提升到作用域的顶层</span>
<span class="token comment">// 这意味着我们的例子可以改写成这个样子</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> declaredButNotAssigned<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>declaredButNotAssigned<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>
    declaredButNotAssigned <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用 const 和 let</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>declaredButNotAssigned<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws a ReferenceError</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> declaredButNotAssigned<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws a ReferenceError</span>
    <span class="token keyword">const</span> declaredButNotAssigned <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>匿名函数表达式的变量名会被提升，但函数内容并不会。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>anonymous<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>
  <span class="token function">anonymous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; TypeError anonymous is not a function</span>
  <span class="token keyword">var</span> <span class="token function-variable function">anonymous</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'anonymous function expression'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>命名的函数表达式的变量名会被提升，但函数名和函数函数内容并不会。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>named<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>

    <span class="token function">named</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; TypeError named is not a function</span>

    <span class="token function">superPower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; ReferenceError superPower is not defined</span>

    <span class="token keyword">var</span> <span class="token function-variable function">named</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">superPower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Flying'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>named<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>

    <span class="token function">named</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; TypeError named is not a function</span>

    <span class="token keyword">var</span> <span class="token function-variable function">named</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">superPower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'named'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>函数声明的名称和函数体都会被提升。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">superPower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; Flying</span>
  <span class="token keyword">function</span> <span class="token function">superPower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Flying'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="具备强类型的设计"><a href="#具备强类型的设计" aria-hidden="true" class="header-anchor">#</a> 具备强类型的设计</h3> <p>解释：</p> <ul><li>如果一个属性被设计为 boolean 类型，则不要使用 1 或 0 作为其值。对于标识性的属性，如对代码体积有严格要求，可以从一开始就设计为 number 类型且将 0 作为否定值。</li> <li>从 DOM 中取出的值通常为 string 类型，如果有对象或函数的接收类型为 number 类型，提前作好转换，而不是期望对象、函数可以处理多类型的值。</li></ul> <h2 id="函数设计"><a href="#函数设计" aria-hidden="true" class="header-anchor">#</a> 函数设计</h2> <div class="tip custom-block"><p class="custom-block-title">注意</p> <p>函数设计基本原则：低耦合，高内聚。（假如一个程序有50个函数；一旦你修改其中一个函数，其他49个函数都需要做修改，这就是高耦合的后果。）</p></div> <h3 id="函数长度"><a href="#函数长度" aria-hidden="true" class="header-anchor">#</a> 函数长度</h3> <p>[建议] 一个函数的长度控制在 50 行以内。 将过多的逻辑单元混在一个大函数中，易导致难以维护。一个清晰易懂的函数应该完成单一的逻辑单元。复杂的操作应进一步抽取，通过函数的调用来体现流程。 特定算法等不可分割的逻辑允许例外。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">syncViewStateOnUserAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>checked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        y<span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        z<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y<span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        warning<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        submitButton<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        warning<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        subnitButton<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 直接阅读该函数会难以明确其主线逻辑，因此下方是一种更合理的表达方式</span>

<span class="token keyword">function</span> <span class="token function">syncViewStateOnUserAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">syncXStateToView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">checkAAvailability</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">syncXStateToView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    y<span class="token punctuation">.</span>checked <span class="token operator">=</span> x<span class="token punctuation">.</span>checked<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>checked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        z<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">checkAAvailability</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearWarnignForA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">displayWarningForAMissing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="参数设计"><a href="#参数设计" aria-hidden="true" class="header-anchor">#</a> 参数设计</h3> <p>[建议] 一个函数的参数控制在 6 个以内。 解释：</p> <ul><li>除去不定长参数以外，函数具备不同逻辑意义的参数建议控制在 6 个以内，过多参数会导致维护难度增大。</li> <li>某些情况下，如使用 AMD Loader 的 require 加载多个模块时，其 callback可能会存在较多参数，因此对函数参数的个数不做强制限制。</li></ul> <p>[建议] 通过 options 参数传递非数据输入型参数。 解释：</p> <ul><li>有些函数的参数并不是作为算法的输入，而是对算法的某些分支条件判断之用，此类参数建议通过一个 options 参数传递。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 如下函数：</span>

<span class="token comment">/**
 * 移除某个元素
 *
 * @param { Node } element 需要移除的元素
 * @param { boolean } removeEventListeners 是否同时将所有注册在元素上的事件移除
 */</span>
 <span class="token keyword">function</span> <span class="token function">removeElement</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> removeEventListeners</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     element<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>removeEventListeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         element<span class="token punctuation">.</span><span class="token function">clearEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

<span class="token comment">//可以转换为下面的签名</span>

<span class="token comment">/**
 * 移除某个元素
 *
 * @param { Node } element 需要移除的元素
 * @param { boolean } removeEventListeners 是否同时将所有注册在元素上的事件移除
 */</span>
 <span class="token keyword">function</span> <span class="token function">removeElement</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> removeEventListeners</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     element<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>removeEventListeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         element<span class="token punctuation">.</span><span class="token function">clearEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>这种模式有几个显著的优势：</p> <ul><li>boolean 型的配置项具备名称，从调用的代码上更易理解其表达的逻辑意义。</li> <li>当配置项有增长时，无需无休止地增加参数个数，不会出现 removeElement(element, true, false, false, 3) 这样难以理解的调用代码。</li> <li>当部分配置参数可选时，多个参数的形式非常难处理重载逻辑，而使用一个 options 对象只需判断属性是否存在，实现得以简化。箭头函数</li> <li>当你必须使用函数表达式（或传递一个匿名函数）时，使用箭头函数符号。为什么？因为箭头函数创造了新的一个 this 执行环境，通常情况下都能满足你的需求，而且这样的写法更为简洁。（ 参考 Arrow functions - JavaScript | MDN  ）</li></ul> <div class="tip custom-block"><p>为什么不？如果你有一个相当复杂的函数，你或许可以把逻辑部分转移到一个函数声明上。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  不推荐</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 推荐</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>如果一个函数适合用一行写出并且只有一个参数，那就把花括号、圆括号和 return 都省略掉。如果不是，那就不要省略。</li></ul> <div class="tip custom-block"><p>为什么？语法糖。在链式调用中可读性很高。 为什么不？当你打算回传一个对象的时候。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 推荐</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 推荐</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> total <span class="token operator">+</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="函数和变量"><a href="#函数和变量" aria-hidden="true" class="header-anchor">#</a> 函数和变量</h3> <p>同一个函数内部，局部变量的声明必须置于顶端 因为即使放到中间，js解析器也会提升至顶部（hosting）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 推荐</span>
<span class="token keyword">var</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> id <span class="token operator">=</span> el<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//  不推荐</span>
<span class="token keyword">var</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> id <span class="token operator">=</span> el<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="块内函数必须用局部变量声明"><a href="#块内函数必须用局部变量声明" aria-hidden="true" class="header-anchor">#</a> 块内函数必须用局部变量声明</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  不推荐</span>
 <span class="token keyword">var</span> <span class="token function-variable function">call</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">&quot;hotel&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hotel foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     foo <span class="token operator">&amp;&amp;</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token comment">// 推荐</span>
 <span class="token keyword">var</span> <span class="token function-variable function">call</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">var</span> foo<span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">&quot;hotel&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hotel foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     foo <span class="token operator">&amp;&amp;</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>引起的bug：第一种写法foo的声明被提前了; 调用call时：第一种写法会调用foo函数，第二种写法不会调用foo函数</p> <h3 id="空函数"><a href="#空函数" aria-hidden="true" class="header-anchor">#</a> 空函数</h3> <p>[建议] 对于性能有高要求的场合，建议存在一个空函数的常量，供多处使用共享。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">EMPTY_FUNCTION</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>abstractMethod <span class="token operator">=</span> <span class="token constant">EMPTY_FUNCTION</span><span class="token punctuation">;</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>before <span class="token operator">=</span> <span class="token constant">EMPTY_FUNCTION</span><span class="token punctuation">;</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>after <span class="token operator">=</span> <span class="token constant">EMPTY_FUNCTION</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="性能优化"><a href="#性能优化" aria-hidden="true" class="header-anchor">#</a> 性能优化</h2> <h3 id="避免不必要的-dom-操作"><a href="#避免不必要的-dom-操作" aria-hidden="true" class="header-anchor">#</a> 避免不必要的 DOM 操作</h3> <p>浏览器遍历 DOM 元素的代价是昂贵的。最简单优化 DOM 树查询的方案是，当一个元素出现多次时，将它保存在一个变量中，就避免多次查询 DOM 树了。</p> <h3 id="缓存数组长度"><a href="#缓存数组长度" aria-hidden="true" class="header-anchor">#</a> 缓存数组长度</h3> <p>循环无疑是和 JavaScript 性能非常相关的一部分。通过存储数组的长度，可以有效避免每次循环重新计算。</p> <div class="tip custom-block"><p>注: 虽然现代浏览器引擎会自动优化这个过程，但是不要忘记还有旧的浏览器。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
len<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
<span class="token comment">// 推荐 - size is calculated only 1 time and then stored</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//  不推荐 - size needs to be recalculated 1000 times</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="优化-javascript-的特征"><a href="#优化-javascript-的特征" aria-hidden="true" class="header-anchor">#</a> 优化 JavaScript 的特征</h3> <ul><li>编写可维护的代码</li> <li>单变量模式</li> <li>Hoisting：把所有变量声明统一放到函数的起始位置 （在后部声明的变量也会被JS视为在头部定义，由此会产生问题）</li> <li>不要扩充内置原型（虽然给Object(), Function()之类的内置原型增加属性和方法很巧妙，但是会破坏可维护性）</li> <li>不要用隐含的类型转换</li> <li>不要用 eval()</li> <li>用 parseInt() 进行数字转换</li> <li>（规范）左大括号的位置</li> <li>构造器首字母大写</li> <li>写注释</li> <li>不要用 void</li> <li>不要用 with 语句</li> <li>不要用 continue 语句</li> <li>尽量不要用位运算</li></ul> <h3 id="优化-javascript-执行"><a href="#优化-javascript-执行" aria-hidden="true" class="header-anchor">#</a> 优化 JavaScript 执行</h3> <p>在页面加载的时候，通常会有很多脚本等待执行，但你可以设定优先级。下面的顺序就是基于用户反馈设定的优先级：
1.改变页面视觉习性的脚本绝对要首先执行。这包括任何的字体调整、盒子布局、或IE6 pngfix。
2.页面内容初始化
3.页面标题、顶部导航和页脚的初始化
4.绑定事件处理器
5.网页流量分析、Doubleclick，以及其他第三方脚本</p> <h3 id="异步加载第三方内容"><a href="#异步加载第三方内容" aria-hidden="true" class="header-anchor">#</a> 异步加载第三方内容</h3> <p>当你无法保证嵌入第三方内容比如 Youtube 视频或者一个 like/tweet 按钮可以正常工作的时候，你需要考虑用异步加载这些代码，避免阻塞整个页面加载。</p> <h2 id="调试"><a href="#调试" aria-hidden="true" class="header-anchor">#</a> 调试</h2> <p>浏览器的怪异性会不可避免地产生一些问题。有几个工具可以帮助优化代码的健全性和加载速度。推荐先在Google Chrome和Firefox做开发，然后用Safari上和Opera，最后针对IE用条件判断做一些额外的微调。下面列出的是一些有帮助的调试器和速度分析器：</p> <ul><li>Google Chrome: Developer Tools</li> <li>Firefox: Firebug, Page Speed, YSlow</li> <li>Safari: Web Inspector</li> <li>Opera: Dragonfly</li> <li>Internet Explorer 6-7: Developer Toolbar</li> <li>Internet Explorer 8-10: Developer Tools</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/122687220/document/edit/master/docs/common/js.md" target="_blank" rel="noopener noreferrer">改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">3/20/2020, 6:02:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/document/common/html.html" class="prev">
          HTML规范
        </a></span> <span class="next"><a href="/document/common/css.html">
          CSS规范
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/document/assets/js/app.11bfe46c.js" defer></script><script src="/document/assets/js/2.9124a432.js" defer></script><script src="/document/assets/js/19.b8279340.js" defer></script>
  </body>
</html>
